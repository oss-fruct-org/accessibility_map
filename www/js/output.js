var color = [
	'img/color/red.png',
	'img/color/green.png',
	'img/color/yellow.png',
	'img/color/grey.png'
	
];

var group = [
	'img/32/Wheelchair.png',
	'img/32/Blind.png',
	'img/32/Walking.png',
	'img/32/Deaf.png',
	'img/32/Mental.png'
];

var array_of_objects = [[
        {name: 'ГБОУ РК «Специализированная школа искусств»'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 4},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 4},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 1}
    ], [
        {name: 'ГБОУ СПО «Техникум дорожного строительства» Корпус №1'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 4},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 2}
    ], [
        {name: 'ГБОУ СПО «Техникум дорожного строительства» Корпус №2'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 3}
    ], [
        {name: 'ГБОУ «Республиканский центр детско-юношеского туризма»'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 4},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 4}
    ], [
        {name: 'ГБОУ НПО «Профучилище №11»'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 4},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 5}
    ], [
        {name: 'ГАОУ СПО "Колледж технологии и предпринимательства" Корпус №1'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 2},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 6}
    ], [
        {name: 'ГАОУ СПО "Колледж технологии и предпринимательства" Корпус №2'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 2},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 7}
    ], [
        {name: 'ГАОУ СПО "Северный колледж"'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 1},
		{id_group: 3,id_access: 1},
		{id_group: 4,id_access: 1},
		{id_group: 5,id_access: 1},
		{category: 'Образование'},
		{id: 8}
    ], [
        {name: 'Объект 9'},
        {id_group: 1,id_access: 2},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 1},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 3},
		{category: 'Образование'},
		{id: 9}
    ], [
        {name: 'Объект 10'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 1},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 10}
    ], [
        {name: 'Объект 11'},
        {id_group: 1,id_access: 2},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 2},
		{id_group: 4,id_access: 1},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 11}
    ], [
        {name: 'Объект 12'},
        {id_group: 1,id_access: 2},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 4},
		{id_group: 5,id_access: 1},
		{category: 'Образование'},
		{id: 12}
    ], [
        {name: 'Объект 13'},
        {id_group: 1,id_access: 4},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 2},
		{id_group: 4,id_access: 1},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 13}
    ], [
        {name: 'Объект 14'},
        {id_group: 1,id_access: 2},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 1},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 14}
    ], [
        {name: 'Объект 15'},
        {id_group: 1,id_access: 3},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 1},
		{id_group: 4,id_access: 4},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 15}
    ], [
        {name: 'Объект 16'},
        {id_group: 1,id_access: 2},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 2},
		{id_group: 4,id_access: 1},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 16}
    ], [
        {name: 'Объект 17'},
        {id_group: 1,id_access: 3},
		{id_group: 2,id_access: 3},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 4},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 17}
    ], [
        {name: 'Объект 18'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 1},
		{id_group: 4,id_access: 3},
		{id_group: 5,id_access: 4},
		{category: 'Образование'},
		{id: 18}
    ], [
        {name: 'Объект 19'},
        {id_group: 1,id_access: 3},
		{id_group: 2,id_access: 1},
		{id_group: 3,id_access: 4},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 19}
    ], [
        {name: 'Объект 20'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Образование'},
		{id: 20}
    ], [
        {name: 'Объект 21'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Здравохранение'},
		{id: 21}
    ], [
        {name: 'Объект 22'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Здравохранение'},
		{id: 22}
    ], [
        {name: 'Объект 23'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Здравохранение'},
		{id: 23}
    ], [
        {name: 'Объект 24'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Здравохранение'},
		{id: 24}
    ], [
        {name: 'Объект 25'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Социальная защита'},
		{id: 25}
    ], [
        {name: 'Объект 26'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Социальная защита'},
		{id: 26}
    ], [
        {name: 'Объект 27'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Социальная защита'},
		{id: 27}
    ], [
        {name: 'Объект 28'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Социальная защита'},
		{id: 28}
    ], [
        {name: 'Объект 29'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Физическая культура'},
		{id: 29}
    ], [
        {name: 'Объект 30'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Физическая культура'},
		{id: 30}
    ], [
        {name: 'Объект 31'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Физическая культура'},
		{id: 31}
    ], [
        {name: 'Объект 32'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Культура'},
		{id: 32}
    ], [
        {name: 'Объект 33'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Культура'},
		{id: 33}
    ], [
        {name: 'Объект 34'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Связь и информация'},
		{id: 34}
    ], [
        {name: 'Объект 35'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Связь и информация'},
		{id: 35}
    ], [
        {name: 'Объект 36'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Транспорт'},
		{id: 36}
    ], [
        {name: 'Объект 37'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Жилой фонд'},
		{id: 37}
    ], [
        {name: 'Объект 38'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Потребительский рынок'},
		{id: 38}
    ], [
        {name: 'Объект 39'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Сфера услуг'},
		{id: 39}
    ], [
        {name: 'Объект 40'},
        {id_group: 1,id_access: 1},
		{id_group: 2,id_access: 2},
		{id_group: 3,id_access: 3},
		{id_group: 4,id_access: 2},
		{id_group: 5,id_access: 2},
		{category: 'Сфера услуг'},
		{id: 40}
    ]];
	

for(var j = 0; j < group.length; j++){
	$(".filter_group").append('<label for="radio-choice'+j+'"><input type="radio" name="radio-choice-group" id="radio-choice'+j+'" value="'+j+'"><img src="'+group[j]+'" width="32" height="32"></label>');
}

for(j = 0; j < color.length; j++){
	$(".filter_access").append('<label for="radio-choice'+j+'"><input type="radio" name="radio-choice-access" id="radio-choice'+j+'" value="'+j+'"><img src="'+color[j]+'" width="32" height="32"></label>');
}

variable = "";
function chouseCategory(array) {
  	var i = 0;
	var k = 0;
	var objects_category = [];
	variable = $("div.col a:hover p").html();
	if(variable.toLowerCase() != 'Все сферы'.toLowerCase()){
		for(i = 0; i < array.length;i++){
			var search_category = _.where(array[i],{category: variable});
			if(search_category.length > 0){
				objects_category[k] = array[i];
				k++;
			}
		}
		filtering(objects_category);
	} else {
		filtering(array);
	}
}

function chouseCategoryReset(array) {
  	var i = 0;
	var k = 0;
	var objects_category = [];
	if(variable.toLowerCase() != 'Все сферы'.toLowerCase()){
		for(i = 0; i < array.length;i++){
			var search_category = _.where(array[i],{category: variable});
			if(search_category.length > 0){
				objects_category[k] = array[i];
				k++;
			}
		}
		filtering(objects_category);
	} else {
		filtering(array);
	}
}

function getObjects(array){

	var i = 0;
	var strcount = 5; 
	var result = [];
	var a = "";
	
	if(strcount < array.length){
		while(i < strcount){
			do{
				var id_random = Math.floor(Math.random()*array.length);
			}while(a.indexOf(""+id_random+"")>=0);
			a +=""+id_random+"";
			result[i] = [];
			result[i][0] = array[id_random][0].name;
			for( var g = 1; g <= group.length; g++){
				result[i][g] = array[id_random][g].id_access;
			}
			result[i][6] = array[id_random][7].id;
			i++;
		}
	} else {
		while(i < array.length){
			result[i] = [];
			result[i][0] = array[i][0].name;
			for( g = 1; g <= group.length; g++){
				result[i][g] = array[i][g].id_access;
			}
			result[i][6] = array[i][7].id;
			i++;
		}
	}
	showObjects(result);
}

function filtering(array){
	var i = 0;
		var s = 0;
		var k = 0;
		var filter_objects = [];
		if(!_.isUndefined($("input[name='radio-choice-group']:checked").val())&&!_.isUndefined($("input[name='radio-choice-access']:checked").val())){
			s = 1;
			for(i = 0; i < array.length; i++){
				var search_key = _.where(array[i],{id_group: parseInt($("input[name='radio-choice-group']:checked").val())+1, id_access: parseInt($("input[name='radio-choice-access']:checked").val())+1});
				if(search_key.length > 0){
					filter_objects[k] = array[i];
					k++;
				}
			}
			getObjects(filter_objects);
			$(".ui-input-search input").attr('data-lastval', '').trigger("change");
		}
	$('input:radio').change(function () {
		var k = 0;
		var filter_objects = [];
		if(!_.isUndefined($("input[name='radio-choice-group']:checked").val())&&!_.isUndefined($("input[name='radio-choice-access']:checked").val())){
			for(i = 0; i < array.length; i++){
				var search_key = _.where(array[i],{id_group: parseInt($("input[name='radio-choice-group']:checked").val())+1, id_access: parseInt($("input[name='radio-choice-access']:checked").val())+1});
				if(search_key.length > 0){
					filter_objects[k] = array[i];
					k++;
				}
			}
			getObjects(filter_objects);
			$(".ui-input-search input").attr('data-lastval', '').trigger("change");
		}
		
		
    });
	if(s == 0){
	getObjects(array);
	}
}

function resetFilter(){
	$("input[name='radio-choice-group']").prop("checked",false).checkboxradio("refresh");
	$("input[name='radio-choice-access']").prop("checked",false).checkboxradio("refresh");
	chouseCategoryReset(array_of_objects);
	$(".ui-input-search input").attr('data-lastval', '').trigger("change");
}

function showObjects(res){
	$("li.added").remove();
	for(var i = 0; i < res.length; i++){
		$("#list_objects").append('<li data-theme="a" data-icon="globe"><a href="#info" onClick="showInformation(this.parentNode.id, array_of_objects)">'+res[i][0]+'<p></p></a>'+
		'<a href="#OSMap" onClick="setCenterObject(this.parentNode.id)" class="ui-btn ui-btn-right ui-btn-inline ui-icon-globe"></a></li>').listview().listview("refresh");
		$("#list_objects li").addClass("added");
		$("p").addClass("card");
	}
	$('#list_objects li').attr('id', function(i) {
        return res[(i+1)-1][6];
    });
	$('ul#list_objects li a p').each(function(index){
		for(var g = 1; g <= group.length; g++){
			$(this).append('<img src="'+color[res[index][g]-1]+'" class="color">');
			$(this).append('<img src="'+group[g-1]+'" class="groupe">');
		}
		
	});
}


